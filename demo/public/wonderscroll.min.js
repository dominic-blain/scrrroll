var Wonderscroll=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?c(t):e}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}var v={unit:"",ease:"linear"},h={unit:"px",ease:"linear"},m={params:{name:void 0,root:"window",from:1,to:0,edge:"top",updateOnInit:!0,updateOnRootResize:!0,direction:"vertical"}},p={observers:m,params:{init:!0,observerNamePrefix:"observer",defaultElement:".wonderscroll"}},y={each:function(t,e){(this.isPlainObject(t)?Object.keys(t):this.forceArray(t)).forEach(e)},forceArray:function(t){return Array.isArray(t)?t:[t]},merge:function(){for(var t={},e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){t=i(i({},t),e)})),t},queryElement:function(t){var e;try{if(t instanceof Element)e=t;else{if("string"!=typeof t)throw"Invalid Element Property: Should be HTMLElement or valid selector.";if(null===(e=document.querySelectorAll(t)))throw"Element Not Found: Could not find Element with ".concat(t," selector.")}}catch(t){console.error(t)}return e},isObject:function(t){return t instanceof Object&&null!==t},isPlainObject:function(t){return!!t.constructor&&t.constructor===Object}},d={linear:function(t){return t},InQuad:function(t){return t*t},OutQuad:function(t){return t*(2-t)},InOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},InCubic:function(t){return t*t*t},OutCubic:function(t){return--t*t*t+1},InOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},InQuart:function(t){return t*t*t*t},OutQuart:function(t){return 1- --t*t*t*t},InOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},InQuint:function(t){return t*t*t*t*t},OutQuint:function(t){return 1+--t*t*t*t*t},InOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}},b=function(){function e(r,n,o){t(this,e);var i=this;i.params=y.merge(h,o),i.element=r,i.key=n,i.cssProperty=n,i.ease=void 0,i.value="",i.init()}return r(e,[{key:"tween",value:function(t){var e=this;e.value=e.params.from+(e.params.to-e.params.from)*e.ease(t)}},{key:"init",value:function(){this._initEase()}},{key:"_initEase",value:function(){var t=d[this.params.ease];this.ease=t||d.linear}},{key:"style",get:function(){return this.value+this.params.unit}}]),e}(),g=function(e){a(o,e);var n=f(o);function o(e,r,i){var a;return t(this,o),c(a=n.call(this,e,r,i)).cssProperty="transform",a}return r(o,[{key:"style",get:function(){var t=this;return o.format[t.key].replace("$",t.value+t.params.unit)}}]),o}(b);g.format={y:"translateY($)",x:"translateX($)",z:"translateZ($)",r:"rotate($)",scale:"scale($)"};var O=function(e){a(o,e);var n=f(o);function o(e,r,i){var a;return t(this,o),i=y.merge(v,i),c(a=n.call(this,e,r,i)).value=[null,null,null,null],a}return r(o,[{key:"tween",value:function(t){var e=this;e.value=e.value.map((function(r,n){var o=e.colors.from[n];return o+(e.colors.to[n]-o)*e.ease(t)}))}},{key:"init",value:function(){this._initEase(),this._initColors()}},{key:"_initColors",value:function(){var t=this;t.colors={from:o.toRGB(t.params.from),to:o.toRGB(t.params.to)}}},{key:"style",get:function(){var t=this,e=4===t.value.length?"rgba":"rgb",r="rgba"===e?", "+t.value[3]:"";return"".concat(e,"(").concat(t.value[0],", ").concat(t.value[1],", ").concat(t.value[2]).concat(r,")")}}],[{key:"toRGB",value:function(t){var e;switch(o.getMode(t)){case"hex":e=o.fromHex(t);break;case"hsl":e=o.fromHSL(t);break;case"rgb":e=o.fromRGB(t);break;default:throw"Mode not found in '".concat(e,". Try supported color modes: hex, rgb. (hsl coming soon)")}return e}},{key:"fromHex",value:function(t){var e;try{var r=o.matchColor(t),n=o.getMode(r);if(!r||"hex"!==n)throw"Hex string is invalid.";var i=r.search(/(?:#|0x)/)+1,a=r.slice(i).match(/.{2}/g);e=[parseInt(a[0],16),parseInt(a[1],16),parseInt(a[2],16),1]}catch(t){console.error(t)}return e}},{key:"fromRGB",value:function(t){var e;try{var r=o.matchColor(t),n=o.getMode(r);if(!r||"rgb"!==n)throw"RGB string is invalid.";var i=r.indexOf("(")+1,a=r.indexOf(")");e=r.slice(i,a).split(",").map((function(t){return Number(t)}))}catch(t){console.error(t)}return e}},{key:"fromHSL",value:function(t){try{var e=o.matchColor(t),r=o.getMode(e);throw e&&"hsl"===r?"HSL is not supported yet.":"HSL string is invalid."}catch(t){console.error(t)}}},{key:"getMode",value:function(t){return-1!==t.search(/(?:#|0x)/)?"hex":-1!==t.search(/hsl/)?"hsl":-1!==t.search(/rgb/)&&"rgb"}},{key:"matchColor",value:function(t){var e=/(?:#|0x)(?:[a-f0-9]{3}|[a-f0-9]{6})\b|(?:rgb|hsl)a?\([^\)]*\)/gi;return t.match(e)?t.match(e)[0]:null}},{key:"getHexDigit",value:function(t){try{if("string"==typeof t){if(1===t.length)return o.hexDigits[t];throw"Digit '".concat(digig,"' must be a single charater")}if("number"==typeof t){if(t<=9&&t>=0)return Math.max(t,1);throw"Digit '".concat(t,"' must be between 0-9")}throw"Digit '".concat(t,"' must be a number or a string.")}catch(t){console.error(t)}}}]),o}(b);O.hexDigits={A:10,B:11,C:12,D:13,E:14,F:15};var w=function e(r,n,o){switch(t(this,e),e.mutatorTypes[n]){case"transform":return new g(r,n,o);case"color":return new O(r,n,o);default:return new b(r,n,o)}};w.mutatorTypes={y:"transform",x:"transform",z:"transform",rotate:"transform",scale:"transform",color:"color",backgroundColor:"color",borderColor:"color"};var k=function(){function e(r,n,o){var i=this;t(this,e);var a=this;a.params=y.merge(m.params,o),a.element=r,a.queue={mutators:n||{}},a.mutators={},a.scroll={current:0,start:void 0,end:void 0,diff:void 0,progress:0},this.isDone=!0,this.isIntersecting=!1,this.isListeningScroll=!1,this.scrollHandler=this._handleScroll.bind(this),this.raf=0,this.intersectionObserver=new IntersectionObserver((function(t){return i._handleIntersecting(!!t[0].isIntersecting)})),this.intersectionObserver.observe(this.element),a.init()}return r(e,[{key:"update",value:function(t){var e=this;void 0!==t&&t instanceof String?e.getMutation(t):e.getMutations(),e.applyMutations()}},{key:"applyMutations",value:function(){var t=this,e={};y.each(t.mutators,(function(r){var n=t.mutators[r];e[n.cssProperty]=e[n.cssProperty]||[],e[n.cssProperty].push(n.style)})),y.each(e,(function(r){var n=e[r].join(" ");t.element.style[r]=n})),t.isDone=0==t.progress||1==t.progress}},{key:"getMutation",value:function(t){this.mutators[t].tween(this.progress)}},{key:"getMutations",value:function(){var t=this;y.each(t.mutators,(function(e){t.getMutation(e)})),t.applyMutations()}},{key:"addMutator",value:function(t,e){var r=this;try{if(void 0!==r.mutators[t])throw"Mutator '".concat(t,"' already exist on '").concat(r.name,"' observer. Try update() instead");r.mutators[t]=new w(r.element,t,e)}catch(t){console.error(t)}}},{key:"addMutators",value:function(t){var e=this;y.each(t,(function(r){e.addMutator(r,t[r])}))}},{key:"init",value:function(){this._initScroll(),this._initMutators()}},{key:"_initMutators",value:function(){var t=this;t.addMutators(t.queue.mutators),t.queue.mutators={},t.params.updateOnInit&&t.update()}},{key:"_initScroll",value:function(){var t=this,e="bottom"===t.params.egde?t.element.offsetHeight:0,r=t.element.offsetTop+e,n=document.body.clientHeight,o=Math.floor(r-n*t.params.from),i=Math.ceil(r-n*t.params.to);t.scroll={current:window.scrollY||0,start:o,end:i,diff:i-o}}},{key:"_handleIntersecting",value:function(t){var e=this,r=!!t;r&&!e.isListeningScroll&&(e.isListeningScroll=!0,window.addEventListener("scroll",e.scrollHandler)),e.isIntersecting=r}},{key:"_handleScroll",value:function(){var t=this;t.scroll.current=window.scrollY;var e=t.progress;e>0&&e<1||!t.isDone?(window.cancelAnimationFrame(t.raf),t.raf=window.requestAnimationFrame(t.update.bind(t))):t.isIntersecting||(t.isListeningScroll=!1,window.removeEventListener("scroll",t.scrollHandler))}},{key:"progress",get:function(){var t=this;return Math.min(Math.max((Math.round(t.scroll.current)-t.scroll.start)/t.scroll.diff,0),1)}}]),e}();return function(){function e(){t(this,e);for(var r,n,o,i=this,a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];s.length<3&&s[0].constructor&&(s[0].constructor==Object||s[0].constructor===Array)?(n=s[0],o=s[1]):(r=s[0],n=s[1],o=s[2]),i.params=y.merge(p.params,o),i.queue={element:r||o.defaultElement,observers:y.forceArray(y.merge(p.observers,n))},i.element=void 0,i.observers=[],i.isInited=!1,i.params.init&&i.init()}return r(e,[{key:"addObserver",value:function(t,e){var r=this,n=r.isInited?r.observers:r.queue.observers,o=!!e&&!!e.name&&"string"==typeof e.name,i=String(r.params.observerNamePrefix)+r.observers.length;e.name=o?e.name:i;var a=new k(r.element,t,e);n.push(a)}},{key:"addObservers",value:function(t){var e=this;y.each(t,(function(t){e.addObserver(t.mutators,t.params)}))}},{key:"init",value:function(){var t=this;t._initElement(),t._initObservers(),t.isInited=!0}},{key:"_initElement",value:function(){var t=this;t.element=y.queryElement(t.queue.element),t.queue.element=void 0}},{key:"_initObservers",value:function(){var t=this;t.addObservers(t.queue.observers),t.queue.observers=[]}}]),e}()}();
