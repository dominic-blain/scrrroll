var Wonderscroll=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?c(e):t}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=s(e);if(t){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}var v={unit:"",ease:"linear"},h={unit:"px",ease:"linear"},m={params:{name:void 0,root:"window",from:1,to:0,edge:"top",direction:"vertical"}},p={observers:m,params:{init:!0,observerNamePrefix:"observer",defaultElement:".wonderscroll",updateOnInit:!0,updateOnResize:!0}},y={each:function(e,t){(this.isPlainObject(e)?Object.keys(e):this.forceArray(e)).forEach((function(e){return t(e)}))},forceArray:function(e){return Array.isArray(e)?e:[e]},merge:function(){for(var e={},t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){e=a(a({},e),t)})),e},queryElement:function(e){var t;try{if(e instanceof Element)t=e;else{if("string"!=typeof e)throw"Invalid Element Property: Should be HTMLElement or valid selector.";if(null===(t=document.querySelectorAll(e))||0===t.length)throw"Element Not Found: Could not find Element with ".concat(e," selector.")}}catch(e){console.error(e)}return t},isObject:function(e){return e instanceof Object&&null!==e},isPlainObject:function(e){return!!e&&!!e.constructor&&e.constructor===Object},isPlainArray:function(e){return!!e&&!!e.constructor&&e.constructor===Array}},d={linear:function(e){return e},InQuad:function(e){return e*e},OutQuad:function(e){return e*(2-e)},InOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},InCubic:function(e){return e*e*e},OutCubic:function(e){return--e*e*e+1},InOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},InQuart:function(e){return e*e*e*e},OutQuart:function(e){return 1- --e*e*e*e},InOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},InQuint:function(e){return e*e*e*e*e},OutQuint:function(e){return 1+--e*e*e*e*e},InOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}},b=function(){function t(r,n,o){e(this,t);var a=this;a.params=y.merge(h,o),a.element=r,a.key=n,a.cssProperty=n,a.ease=void 0,a.value="",a.init()}return r(t,[{key:"tween",value:function(e){var t=this;t.value=t.params.from+(t.params.to-t.params.from)*t.ease(e)}},{key:"init",value:function(){this._initEase()}},{key:"_initEase",value:function(){var e=d[this.params.ease];this.ease=e||d.linear}},{key:"style",get:function(){return this.value+this.params.unit}}]),t}(),g=function(t){i(o,t);var n=f(o);function o(t,r,a){var i;return e(this,o),c(i=n.call(this,t,r,a)).cssProperty="transform",i}return r(o,[{key:"style",get:function(){var e=this,t=o.format[e.key];return(t||"".concat(e.key,"($)")).replace("$",e.value+e.params.unit)}}]),o}(b);g.format={y:"translateY($)",x:"translateX($)",z:"translateZ($)",r:"rotate($)"};var O=function(t){i(o,t);var n=f(o);function o(t,r,a){var i;return e(this,o),a=y.merge(v,a),c(i=n.call(this,t,r,a)).value=[null,null,null,null],i}return r(o,[{key:"tween",value:function(e){var t=this;t.value=t.value.map((function(r,n){var o=t.colors.from[n];return o+(t.colors.to[n]-o)*t.ease(e)}))}},{key:"init",value:function(){this._initEase(),this._initColors()}},{key:"_initColors",value:function(){var e=this;e.colors={from:o.toRGB(e.params.from),to:o.toRGB(e.params.to)}}},{key:"style",get:function(){var e=this,t=4===e.value.length?"rgba":"rgb",r="rgba"===t?", "+e.value[3]:"";return"".concat(t,"(").concat(e.value[0],", ").concat(e.value[1],", ").concat(e.value[2]).concat(r,")")}}],[{key:"toRGB",value:function(e){var t;switch(o.getMode(e)){case"hex":t=o.fromHex(e);break;case"hsl":t=o.fromHSL(e);break;case"rgb":t=o.fromRGB(e);break;default:throw"Mode not found in '".concat(t,". Try supported color modes: hex, rgb. (hsl coming soon)")}return t}},{key:"fromHex",value:function(e){var t;try{var r=o.matchColor(e),n=o.getMode(r);if(!r||"hex"!==n)throw"Hex string is invalid.";var a=r.search(/(?:#|0x)/)+1,i=r.slice(a).match(/.{2}/g);t=[parseInt(i[0],16),parseInt(i[1],16),parseInt(i[2],16),1]}catch(e){console.error(e)}return t}},{key:"fromRGB",value:function(e){var t;try{var r=o.matchColor(e),n=o.getMode(r);if(!r||"rgb"!==n)throw"RGB string is invalid.";var a=r.indexOf("(")+1,i=r.indexOf(")");t=r.slice(a,i).split(",").map((function(e){return Number(e)}))}catch(e){console.error(e)}return t}},{key:"fromHSL",value:function(e){try{var t=o.matchColor(e),r=o.getMode(t);throw t&&"hsl"===r?"HSL is not supported yet.":"HSL string is invalid."}catch(e){console.error(e)}}},{key:"getMode",value:function(e){return-1!==e.search(/(?:#|0x)/)?"hex":-1!==e.search(/hsl/)?"hsl":-1!==e.search(/rgb/)&&"rgb"}},{key:"matchColor",value:function(e){var t=/(?:#|0x)(?:[a-f0-9]{3}|[a-f0-9]{6})\b|(?:rgb|hsl)a?\([^\)]*\)/gi;return e.match(t)?e.match(t)[0]:null}}]),o}(b),w=function t(r,n,o){switch(e(this,t),t.mutatorTypes[n]){case"transform":return new g(r,n,o);case"color":return new O(r,n,o);default:return new b(r,n,o)}};w.mutatorTypes={y:"transform",translateY:"transform",x:"transform",translateX:"transform",z:"transform",translateZ:"transform",r:"transform",rotate:"transform",scale:"transform",color:"color",backgroundColor:"color",borderColor:"color"};var k=function(){function t(r,n,o){e(this,t);var a=this;a.params=y.merge(m.params,o),a.element=r,a.queue={mutators:n||{}},a.mutators={},a.scroll={current:0,start:void 0,end:void 0,diff:void 0,progress:0},a.isDone=!1,a.init()}return r(t,[{key:"applyMutations",value:function(e){var t=this;y.each(e,(function(r){var n=e[r].join(" ");t.element.style[r]=n})),t.isDone=0==t.progress||1==t.progress}},{key:"getMutationsStyles",value:function(){var e=this,t={};return y.each(e.mutators,(function(r){var n=e.mutators[r];t[r]={cssProperty:n.cssProperty,cssValue:n.style}})),t}},{key:"getMutation",value:function(e){var t=this,r=t.progress;r>0&&r<1&&(t.isDone=!1),t.mutators[e].tween(t.progress)}},{key:"getMutations",value:function(){var e=this;y.each(e.mutators,(function(t){e.getMutation(t)}))}},{key:"addMutator",value:function(e,t){var r=this;try{if(void 0!==r.mutators[e])throw"Mutator '".concat(e,"' already exist on '").concat(r.name,"' observer. Try update() instead");r.mutators[e]=new w(r.element,e,t)}catch(e){console.error(e)}}},{key:"addMutators",value:function(e){var t=this;y.each(e,(function(r){t.addMutator(r,e[r])}))}},{key:"init",value:function(){this._initScroll(),this._initMutators()}},{key:"_initMutators",value:function(){var e=this;e.addMutators(e.queue.mutators),e.queue.mutators={}}},{key:"_initScroll",value:function(){var e=this,t=e.element.offsetHeight,r=document.body.clientHeight,n="bottom"===e.params.edge?t:0,o="both"===e.params.edge?t:0,a=e.element.offsetTop+n,i=Math.floor(a-r*e.params.from),s=Math.ceil(a+o-r*e.params.to);e.scroll={current:window.scrollY||0,start:i,end:s,diff:s-i}}},{key:"progress",get:function(){var e=this,t=Math.min(Math.max((Math.round(e.scroll.current)-e.scroll.start)/e.scroll.diff,0),1);return e.element.setAttribute("data-progress-".concat(e.params.name),t),t}}]),t}();return function(){function t(){e(this,t);for(var r,n,o,a=this,i=arguments.length,s=new Array(i),u=0;u<i;u++)s[u]=arguments[u];if(s.length<3&&(y.isPlainObject(s[0])||y.isPlainArray(s[0]))?(n=s[0],o=s[1]):(r=s[0],n=s[1],o=s[2]),a.params=y.merge(p.params,o),a.queue={element:r||a.params.defaultElement,observers:y.forceArray(n).map((function(e){return y.merge(p.observers,e)}))},a.element=void 0,a.observers=[],a.raf=0,a.scrollPos=0,a.scrollHandler=a._handleScroll.bind(this),a.isInitiating=!1,a.isInited=!1,a.isOnScreen=!1,a.isListeningScroll=!1,a.isActive=!0,a.params.init){var c=a.init();if(c&&c.length>1)return c}}return r(t,[{key:"update",value:function(e){var t=this;t.getMutations(),t.isActive?(window.cancelAnimationFrame(t.raf),t.raf=window.requestAnimationFrame(t.applyMutations.bind(t))):t.isOnScreen||(t.isListeningScroll=!1,window.removeEventListener("scroll",t.scrollHandler))}},{key:"getMutations",value:function(){var e=this;y.each(e.observers,(function(t){t.scroll.current=e.scrollPos,t.getMutations(),t.isDone||(e.isActive=!0)}))}},{key:"applyMutations",value:function(){var e=this,t={},r={},n=!1;y.each(e.observers,(function(e){var r=e.progress,o=0==r||1==r,a=e.getMutationsStyles();y.each(a,(function(e){var r=a[e];t[e]&&o||(t[e]=r)})),e.isDone=o,o||(n=!0)})),y.each(t,(function(e){var n=t[e];r[n.cssProperty]=y.isPlainArray(r[n.cssProperty])?r[n.cssProperty]:[],r[n.cssProperty].push(n.cssValue)})),y.each(r,(function(t){var n=r[t].join(" ");e.element.style[t]=n})),e.isActive=n}},{key:"addObserver",value:function(e,t){var r=this,n=r.isInited||r.isInitiating?r.observers:r.queue.observers,o=!!t&&!!t.name&&"string"==typeof t.name,a=String(r.params.observerNamePrefix)+r.observers.length;t.name=o?t.name:a;var i=new k(r.element,e,t);n.push(i)}},{key:"addObservers",value:function(e){var t=this;y.each(e,(function(e){t.addObserver(e.mutators,e.params)}))}},{key:"_handleIntersecting",value:function(e){var t=this;t.isOnScreen=!!e[0].isIntersecting,t.isOnScreen&&!t.isListeningScroll&&(t.isListeningScroll=!0,window.addEventListener("scroll",t.scrollHandler))}},{key:"_handleScroll",value:function(){this.scrollPos=window.scrollY,this.update()}},{key:"init",value:function(){var e=this;if(e.isInitiating=!0,e._initElement(),e.element.length>1){var r=[];return e.element.forEach((function(n){r.push(new t(n,e.queue.observers,e.params))})),r}e._initObservers(),e.intersectionObserver=new IntersectionObserver((function(t){return e._handleIntersecting(t)})),e.intersectionObserver.observe(e.element),e.params.updateOnInit&&e.update(),e.isInited=!0}},{key:"_initElement",value:function(){var e=this,t=y.queryElement(e.queue.element);e.element=t,e.queue.element=null}},{key:"_initObservers",value:function(){var e=this;e.addObservers(e.queue.observers),e.queue.observers=[]}},{key:"activeObservers",get:function(){var e=[];return y.each(this.observers,(function(t){t.isDone||e.push(t)})),this.isActive=!!e.length&&e.length>0,e}}]),t}()}();
