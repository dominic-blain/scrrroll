var Wonderscroll=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?c(e):t}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=s(e);if(t){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}var v={unit:"",ease:"linear"},h={unit:"px",ease:"linear"},m={params:{name:void 0,root:"window",from:1,to:0,edge:"top",updateOnInit:!0,updateOnRootResize:!0,direction:"vertical"}},p={observers:m,params:{init:!0,observerNamePrefix:"observer",defaultElement:".wonderscroll"}},d={each:function(e,t){(this.isPlainObject(e)?Object.keys(e):this.forceArray(e)).forEach((function(e){return t(e)}))},forceArray:function(e){return Array.isArray(e)?e:[e]},merge:function(){for(var e={},t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){e=i(i({},e),t)})),e},queryElement:function(e){var t;try{if(e instanceof Element)t=e;else{if("string"!=typeof e)throw"Invalid Element Property: Should be HTMLElement or valid selector.";if(null===(t=document.querySelectorAll(e))||0===t.length)throw"Element Not Found: Could not find Element with ".concat(e," selector.")}}catch(e){console.error(e)}return t},isObject:function(e){return e instanceof Object&&null!==e},isPlainObject:function(e){return!!e.constructor&&e.constructor===Object},isPlainArray:function(e){return!!e.constructor&&e.constructor===Array}},y={linear:function(e){return e},InQuad:function(e){return e*e},OutQuad:function(e){return e*(2-e)},InOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},InCubic:function(e){return e*e*e},OutCubic:function(e){return--e*e*e+1},InOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},InQuart:function(e){return e*e*e*e},OutQuart:function(e){return 1- --e*e*e*e},InOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},InQuint:function(e){return e*e*e*e*e},OutQuint:function(e){return 1+--e*e*e*e*e},InOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}},b=function(){function t(r,n,o){e(this,t);var i=this;i.params=d.merge(h,o),i.element=r,i.key=n,i.cssProperty=n,i.ease=void 0,i.value="",i.init()}return r(t,[{key:"tween",value:function(e){var t=this;t.value=t.params.from+(t.params.to-t.params.from)*t.ease(e)}},{key:"init",value:function(){this._initEase()}},{key:"_initEase",value:function(){var e=y[this.params.ease];this.ease=e||y.linear}},{key:"style",get:function(){return this.value+this.params.unit}}]),t}(),g=function(t){a(o,t);var n=f(o);function o(t,r,i){var a;return e(this,o),c(a=n.call(this,t,r,i)).cssProperty="transform",a}return r(o,[{key:"style",get:function(){var e=this;return o.format[e.key].replace("$",e.value+e.params.unit)}}]),o}(b);g.format={y:"translateY($)",x:"translateX($)",z:"translateZ($)",r:"rotate($)",scale:"scale($)"};var O=function(t){a(o,t);var n=f(o);function o(t,r,i){var a;return e(this,o),i=d.merge(v,i),c(a=n.call(this,t,r,i)).value=[null,null,null,null],a}return r(o,[{key:"tween",value:function(e){var t=this;t.value=t.value.map((function(r,n){var o=t.colors.from[n];return o+(t.colors.to[n]-o)*t.ease(e)}))}},{key:"init",value:function(){this._initEase(),this._initColors()}},{key:"_initColors",value:function(){var e=this;e.colors={from:o.toRGB(e.params.from),to:o.toRGB(e.params.to)}}},{key:"style",get:function(){var e=this,t=4===e.value.length?"rgba":"rgb",r="rgba"===t?", "+e.value[3]:"";return"".concat(t,"(").concat(e.value[0],", ").concat(e.value[1],", ").concat(e.value[2]).concat(r,")")}}],[{key:"toRGB",value:function(e){var t;switch(o.getMode(e)){case"hex":t=o.fromHex(e);break;case"hsl":t=o.fromHSL(e);break;case"rgb":t=o.fromRGB(e);break;default:throw"Mode not found in '".concat(t,". Try supported color modes: hex, rgb. (hsl coming soon)")}return t}},{key:"fromHex",value:function(e){var t;try{var r=o.matchColor(e),n=o.getMode(r);if(!r||"hex"!==n)throw"Hex string is invalid.";var i=r.search(/(?:#|0x)/)+1,a=r.slice(i).match(/.{2}/g);t=[parseInt(a[0],16),parseInt(a[1],16),parseInt(a[2],16),1]}catch(e){console.error(e)}return t}},{key:"fromRGB",value:function(e){var t;try{var r=o.matchColor(e),n=o.getMode(r);if(!r||"rgb"!==n)throw"RGB string is invalid.";var i=r.indexOf("(")+1,a=r.indexOf(")");t=r.slice(i,a).split(",").map((function(e){return Number(e)}))}catch(e){console.error(e)}return t}},{key:"fromHSL",value:function(e){try{var t=o.matchColor(e),r=o.getMode(t);throw t&&"hsl"===r?"HSL is not supported yet.":"HSL string is invalid."}catch(e){console.error(e)}}},{key:"getMode",value:function(e){return-1!==e.search(/(?:#|0x)/)?"hex":-1!==e.search(/hsl/)?"hsl":-1!==e.search(/rgb/)&&"rgb"}},{key:"matchColor",value:function(e){var t=/(?:#|0x)(?:[a-f0-9]{3}|[a-f0-9]{6})\b|(?:rgb|hsl)a?\([^\)]*\)/gi;return e.match(t)?e.match(t)[0]:null}}]),o}(b),w=function t(r,n,o){switch(e(this,t),t.mutatorTypes[n]){case"transform":return new g(r,n,o);case"color":return new O(r,n,o);default:return new b(r,n,o)}};w.mutatorTypes={y:"transform",x:"transform",z:"transform",rotate:"transform",scale:"transform",color:"color",backgroundColor:"color",borderColor:"color"};var k=function(){function t(r,n,o){var i=this;e(this,t);var a=this;a.params=d.merge(m.params,o),a.element=r,a.queue={mutators:n||{}},a.mutators={},a.scroll={current:0,start:void 0,end:void 0,diff:void 0,progress:0},this.isDone=!0,this.isIntersecting=!1,this.isListeningScroll=!1,this.scrollHandler=this._handleScroll.bind(this),this.raf=0,this.intersectionObserver=new IntersectionObserver((function(e){return i._handleIntersecting(!!e[0].isIntersecting)})),this.intersectionObserver.observe(this.element),a.init()}return r(t,[{key:"update",value:function(e){var t=this;void 0!==e&&e instanceof String?t.getMutation(e):t.getMutations(),t.applyMutations()}},{key:"applyMutations",value:function(){var e=this,t={};d.each(e.mutators,(function(r){var n=e.mutators[r];t[n.cssProperty]=t[n.cssProperty]||[],t[n.cssProperty].push(n.style)})),d.each(t,(function(r){var n=t[r].join(" ");e.element.style[r]=n})),e.isDone=0==e.progress||1==e.progress}},{key:"getMutation",value:function(e){this.mutators[e].tween(this.progress)}},{key:"getMutations",value:function(){var e=this;d.each(e.mutators,(function(t){e.getMutation(t)}))}},{key:"addMutator",value:function(e,t){var r=this;try{if(void 0!==r.mutators[e])throw"Mutator '".concat(e,"' already exist on '").concat(r.name,"' observer. Try update() instead");r.mutators[e]=new w(r.element,e,t)}catch(e){console.error(e)}}},{key:"addMutators",value:function(e){var t=this;d.each(e,(function(r){t.addMutator(r,e[r])}))}},{key:"init",value:function(){this._initScroll(),this._initMutators()}},{key:"_initMutators",value:function(){var e=this;e.addMutators(e.queue.mutators),e.queue.mutators={},e.params.updateOnInit&&e.update()}},{key:"_initScroll",value:function(){var e=this,t=e.element.offsetHeight,r=document.body.clientHeight,n="bottom"===e.params.edge?t:0,o="both"===e.params.edge?t:0,i=e.element.offsetTop+n,a=Math.floor(i-r*e.params.from),s=Math.ceil(i+o-r*e.params.to);e.scroll={current:window.scrollY||0,start:a,end:s,diff:s-a}}},{key:"_handleIntersecting",value:function(e){var t=this,r=!!e;r&&!t.isListeningScroll&&(t.isListeningScroll=!0,window.addEventListener("scroll",t.scrollHandler)),t.isIntersecting=r}},{key:"_handleScroll",value:function(){var e=this;e.scroll.current=window.scrollY;var t=e.progress;t>0&&t<1||!e.isDone?(window.cancelAnimationFrame(e.raf),e.raf=window.requestAnimationFrame(e.update.bind(e))):e.isIntersecting||(e.isListeningScroll=!1,window.removeEventListener("scroll",e.scrollHandler))}},{key:"progress",get:function(){var e=this;return Math.min(Math.max((Math.round(e.scroll.current)-e.scroll.start)/e.scroll.diff,0),1)}}]),t}();return function(){function t(){e(this,t);for(var r,n,o,i=this,a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];if(s.length<3&&(d.isPlainObject(s[0])||d.isPlainArray(s[0]))?(n=s[0],o=s[1]):(r=s[0],n=s[1],o=s[2]),i.params=d.merge(p.params,o),i.queue={element:r||i.params.defaultElement,observers:d.forceArray(n).map((function(e){return d.merge(p.observers,e)}))},i.element=void 0,i.observers=[],i.isInited=!1,i.params.init){var c=i.init();if(c&&c.length>1)return c}}return r(t,[{key:"addObserver",value:function(e,t){var r=this,n=r.isInited?r.observers:r.queue.observers,o=!!t&&!!t.name&&"string"==typeof t.name,i=String(r.params.observerNamePrefix)+r.observers.length;t.name=o?t.name:i;var a=new k(r.element,e,t);n.push(a)}},{key:"addObservers",value:function(e){var t=this;d.each(e,(function(e){t.addObserver(e.mutators,e.params)}))}},{key:"init",value:function(){var e=this;if(e._initElement(),e.element.length>1){var r=[];return e.element.forEach((function(n){r.push(new t(n,e.queue.observers,e.params))})),r}e._initObservers(),e.isInited=!0}},{key:"_initElement",value:function(){var e=this,t=d.queryElement(e.queue.element);e.element=t,e.queue.element=void 0}},{key:"_initObservers",value:function(){var e=this;e.addObservers(e.queue.observers),e.queue.observers=[]}}]),t}()}();
